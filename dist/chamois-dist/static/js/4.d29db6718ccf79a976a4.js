webpackJsonp([4],{"4frb":function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.loading?s("span",[s("i",{staticClass:"fa fa-spin fa-spinner"})]):s("div",{staticClass:"checkbox"},e._l(e.csList,function(t){return s("label",{key:t.id,staticClass:"m-r-sm"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.checkboxCS[t.username],expression:"checkboxCS[cs.username]"}],attrs:{type:"checkbox",name:"cs"},domProps:{checked:Array.isArray(e.checkboxCS[t.username])?e._i(e.checkboxCS[t.username],null)>-1:e.checkboxCS[t.username]},on:{change:function(s){var a=e.checkboxCS[t.username],o=s.target,n=!!o.checked;if(Array.isArray(a)){var r=e._i(a,null);o.checked?r<0&&e.$set(e.checkboxCS,t.username,a.concat([null])):r>-1&&e.$set(e.checkboxCS,t.username,a.slice(0,r).concat(a.slice(r+1)))}else e.$set(e.checkboxCS,t.username,n)}}}),e._v(" "),s("i",{staticClass:"dark-white"}),e._v("\n    "+e._s(t.username)+"\n  ")])}),0)},staticRenderFns:[]}},"9OnP":function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("form",{staticClass:"form text-sm",on:{submit:function(t){return t.preventDefault(),e.submit(t)}}},[s("div",{staticClass:"box"},[s("div",{staticClass:"box-body clearfix form-input-sm"},[s("div",{staticClass:"row m-l-xs m-r-xs"},[s("div",{staticClass:"pull-left m-r-xs"},[s("label",{staticClass:"form-control-label p-b-0",class:{"text-blue":e.query.username_q}},[e._v(e._s(e.$t("common.username"))+"\n            ")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.query.username_q,expression:"query.username_q"}],staticClass:"form-control w-sm",attrs:{placeholder:e.$t("common.username")},domProps:{value:e.query.username_q},on:{input:[function(t){t.target.composing||e.$set(e.query,"username_q",t.target.value)},e.search]}})]),e._v(" "),s("div",{staticClass:"pull-left m-r-xs"},[s("label",{staticClass:"form-control-label p-b-0",class:{"text-blue":e.query.nickname_q}},[e._v(e._s(e.$t("common.nickname"))+"\n            ")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.query.nickname_q,expression:"query.nickname_q"}],staticClass:"form-control w-sm",attrs:{placeholder:e.$t("common.nickname")},domProps:{value:e.query.nickname_q},on:{input:[function(t){t.target.composing||e.$set(e.query,"nickname_q",t.target.value)},e.search]}})]),e._v(" "),s("div",{staticClass:"pull-left m-r-xs"},[s("label",{staticClass:"form-control-label p-b-0",class:{"text-blue":e.query.promote_code_q}},[e._v(e._s(e.$t("common.promote_code"))+"\n            ")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.query.promote_code_q,expression:"query.promote_code_q"}],staticClass:"form-control w-sm",attrs:{placeholder:e.$t("common.promote_code")},domProps:{value:e.query.promote_code_q},on:{input:[function(t){t.target.composing||e.$set(e.query,"promote_code_q",t.target.value)},e.search]}})]),e._v(" "),s("button",{staticClass:"md-btn pull-right btn m-t-md w-xs",attrs:{type:"button",disabled:e.isQueryEmpty},on:{click:e.clearAll}},[s("span",[e.loading?s("i",{staticClass:"fa fa-spin fa-spinner"}):s("i",{staticClass:"fa fa-trash-o"}),e._v("\n               "+e._s(e.$t("action.clear"))+"\n            ")])])])])])]),e._v(" "),s("div",{staticClass:"box"},[s("table",{staticClass:"table table-striped",attrs:{"st-table":"rowCollectionBasic"}},[s("thead",[s("tr",[s("th",{staticStyle:{width:"15%"}},[e._v(e._s(e.$t("common.username")))]),e._v(" "),s("th",[e._v(e._s(e.$t("common.nickname")))]),e._v(" "),s("th",[e._v(e._s(e.$t("common.mobile")))]),e._v(" "),s("th",[e._v(e._s(e.$t("common.QQ")))]),e._v(" "),s("th",[e._v(e._s(e.$t("common.agent_domain")))]),e._v(" "),s("th",[e._v(e._s(e.$t("common.promote_code")))]),e._v(" "),s("th",[e._v(e._s(e.$t("common.promote_number")))]),e._v(" "),s("th",[e._v(e._s(e.$t("role.customer_service")))]),e._v(" "),s("th",{staticClass:"text-center",staticStyle:{width:"13%"}},[e._v(e._s(e.$t("common.operate")))])])]),e._v(" "),e.queryset.length?s("tbody",e._l(e.queryset,function(t){return s("tr",{key:t.id},[s("td",[e._v(e._s(t.username||"-"))]),e._v(" "),s("td",[e._v(e._s(t.nickname||"-"))]),e._v(" "),s("td",[e._v(e._s(t.mobile||"-"))]),e._v(" "),s("td",[e._v(e._s(t.QQ||"-"))]),e._v(" "),s("td",[e._v(e._s(t.domain||"-"))]),e._v(" "),s("td",[e._v(e._s(t.promote_code||"-"))]),e._v(" "),Number.isInteger(t.invited_member_count)?s("td",[e._v(e._s(t.invited_member_count))]):s("td",[e._v("-")]),e._v(" "),t.agent_customer_services&&t.agent_customer_services.length>0?s("td",e._l(t.agent_customer_services,function(t,a){return s("span",{key:t.id},[a>0?s("br"):e._e(),e._v(e._s(t.username)+"\n            ")])}),0):s("td",[e._v("-")]),e._v(" "),s("td",{staticClass:"text-center"},[s("button",{staticClass:"btn btn-xs btn-icon blue",on:{click:function(s){e.openModal(Object.assign({},t,{roles:t.roles.map(function(e){return e.name}),domain:t.domain||"",agent_customer_services:t.agent_customer_services?t.agent_customer_services.map(function(e){return e.username}):[]}))}}},[s("i",{staticClass:"fa fa-edit"})]),e._v(" "),s("router-link",{staticClass:"m-l-sm",attrs:{to:{path:"/member-list/",query:{agent_q:t.username}}}},[e._v(e._s(e.$t("action.view_object",{object:e.$t("common.member")}))+"\n            ")])],1)])}),0):e._e()])]),e._v(" "),e.modal.showModal?s("div",{staticClass:"modal"},[s("div",{staticClass:"modal-backdrop fade in",on:{click:function(t){e.modal.showModal=!1}}}),e._v(" "),s("form",{staticClass:"form",on:{submit:function(t){t.preventDefault(),e.updateMember(Object.assign({},e.modal.member,{role_names:e.modal.member.roles}))}}},[s("div",{staticClass:"modal-dialog"},[s("div",{staticClass:"modal-content"},[s("div",{staticClass:"modal-header"},[s("h5",{staticClass:"modal-title"},[e._v("\n              "+e._s(e.$t("action.update_object",{object:e.$t("common.agent")+": "+e.modal.member.username}))+"\n            ")])]),e._v(" "),s("div",{staticClass:"modal-body p-lg"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-sm-12 text-center"},[s("h6",[e._v(e._s(e.$t("nav.agent_promo")))])])]),e._v(" "),s("div",{staticClass:"row m-t-xs"},[s("div",{staticClass:"col-sm-3 col-sm-offset-1 text-right"},[s("label",{staticClass:"form-control-label"},[e._v(e._s(e.$t("common.promote_code")))])]),e._v(" "),s("div",{staticClass:"col-sm-5"},[s("label",{staticClass:"form-control-label p-l-0"},[e._v(e._s(e.modal.member.promote_code))])])]),e._v(" "),s("div",{staticClass:"row m-t-xs"},[s("div",{staticClass:"col-sm-3 col-sm-offset-1 text-right"},[s("label",{staticClass:"form-control-label"},[e._v(e._s(e.$t("common.agent_domain")))])]),e._v(" "),s("div",{staticClass:"col-sm-5"},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.modal.member.domain,expression:"modal.member.domain",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{placeholder:"多个域名请用','隔开"},domProps:{value:e.modal.member.domain},on:{input:function(t){t.target.composing||e.$set(e.modal.member,"domain",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})])]),e._v(" "),s("div",{staticClass:"row m-t-xs"},[s("div",{staticClass:"col-sm-3 col-sm-offset-1 text-right"},[s("label",{staticClass:"form-control-label"},[e._v(e._s(e.$t("role.customer_service")))])]),e._v(" "),s("div",{staticClass:"col-sm-6 m-t-sm"},[s("customer-service",{attrs:{customerService:e.modal.member.agent_customer_services},on:{"cs-select":e.csSelect}})],1)])]),e._v(" "),s("div",{staticClass:"modal-footer"},[s("button",{staticClass:"btn dark-white p-x-md w-xs",attrs:{type:"button"},on:{click:function(t){e.modal.showModal=!1}}},[e._v("\n              "+e._s(e.$t("action.cancel"))+"\n            ")]),e._v(" "),s("button",{staticClass:"btn blue p-x-md w-xs",attrs:{type:"submit"}},[e.modal.loading?s("span",[s("i",{staticClass:"fa fa-spin fa-spinner"})]):s("span",[e._v(e._s(e.$t("action.confirm")))])])])])])])]):e._e(),e._v(" "),s("pulling",{ref:"pulling",attrs:{api:e.api,extra:e.extra,query:e.query,queryset:e.queryset},on:{"query-data":e.queryData,"query-param":e.queryParam}})],1)},staticRenderFns:[]}},FJ6v:function(e,t,s){var a=s("VU/8")(s("LmzE"),s("4frb"),null,null);e.exports=a.exports},LmzE:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("fZjL"),o=s.n(a),n=s("n5Qe");t.default={props:{customerService:{default:""}},data:function(){return{api:n.a.manageUser,csList:[],checkboxCS:{},loading:!0}},watch:{customerService:function(e,t){var s=this;e.forEach(function(e){s.$set(s.checkboxCS,e,!0)})},checkboxCS:{handler:function(e){this.$emit("cs-select",o()(e).filter(function(t){return e[t]}))},deep:!0}},created:function(){var e=this;this.$http.get(this.api+"?roles=customer service").then(function(t){e.csList=t.sort(function(t,s){return e.customerService.includes(t.username)?-1:1}),e.loading=!1}),this.customerService&&this.customerService.length&&this.customerService.forEach(function(t){e.$set(e.checkboxCS,t,!0)})}}},PopC:function(e,t,s){var a=s("VU/8")(s("tGn2"),s("9OnP"),null,null);e.exports=a.exports},tGn2:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("woOf"),o=s.n(a),n=s("//Fk"),r=s.n(n),i=s("8h12"),c=s.n(i),l=s("FJ6v"),m=s.n(l),u=s("n5Qe"),d=s("oFuF"),_=s("M4fF"),v=s.n(_);t.default={data:function(){return{api:u.a.manageUser,extra:"roles=agent&sort=date_joined",query:{},queryset:[],modal:{showModal:!1,member:{},loading:!1},requiredFields:["username","nickname","mobile","QQ","role_names","promote_code","domain","agent_customer_services"],loading:!0}},created:function(){var e=this;this.setQueryAll(),this.$nextTick(function(){e.$refs.pulling.rebase()})},watch:{$route:{handler:function(){this.loading=!0,this.setQueryAll(),this.queryset=[],this.$refs.pulling.rebase()},deep:!0}},computed:{isQueryEmpty:function(){return d.a.compareQuery(this.query,{})}},methods:{getPromo:function(){var e=this;return new r.a(function(t){e.$http.get(u.a.user+"promote_info/").then(function(e){t(e)})})},setQueryAll:function(){this.query=o()({},this.$route.query)},openModal:function(e){var t=this;this.modal=o()(this.modal,{member:e,showModal:!0,loading:!1}),e.promote_code||this.getPromo().then(function(s){t.modal.member=o()(e,s)})},closeModal:function(){this.modal.showModal=!1},updateMember:function(e){var t=this;this.modal.loading=!0;var s={};this.requiredFields.forEach(function(t){s[t]=e[t]}),this.$http.put(""+this.api+e.id+"/",s).then(function(e){t.modal.loading=!1,t.notify("success","success",!0,!0)},function(e){t.modal.loading=!1,t.notify("danger","failed",!1,!1,e)})},csSelect:function(e){this.modal.member.agent_customer_services=e},queryData:function(e){this.loading=!1,this.queryset=e},queryParam:function(e){this.query=o()(this.query,e)},search:v.a.debounce(function(){this.submit()},700),submit:function(){d.a.compareQuery(this.query,this.$route.query)||this.$refs.pulling.submit()},rebase:function(){this.$refs.pulling.rebase()},clearAll:function(){var e=this;this.query={},this.$nextTick(function(){e.submit()})},notify:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"success",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";d.a.notify({message:this.$t("action.update")+this.$t("status."+t)+(o&&" ("+o+")"),type:e}),s&&this.closeModal(),a&&this.rebase()}},components:{Pulling:c.a,CustomerService:m.a}}}});
//# sourceMappingURL=4.d29db6718ccf79a976a4.js.map